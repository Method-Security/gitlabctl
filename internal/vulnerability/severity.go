package vulnerability

import (
	"strings"
)

type Severity string

const (
	SeverityUnknown  Severity = "unknown"
	SeverityInfo     Severity = "info"
	SeverityLow      Severity = "low"
	SeverityMedium   Severity = "medium"
	SeverityHigh     Severity = "high"
	SeverityCritical Severity = "critical"
)

func ToSeverity(severity string) Severity {
	switch strings.ToLower(severity) {
	case "info":
		return SeverityInfo
	case "low":
		return SeverityLow
	case "medium":
		return SeverityMedium
	case "high":
		return SeverityHigh
	case "critical":
		return SeverityCritical
	}
	return SeverityUnknown
}

func ToSeverities(severities []string) []Severity {
	result := make([]Severity, 0)
	for _, severity := range severities {
		result = append(result, ToSeverity(severity))
	}
	return result
}

func ContainsSeverity(severity Severity, severities []Severity) bool {
	for _, s := range severities {
		if s == severity {
			return true
		}
	}
	return false
}

package vulnerability

import (
	"strings"
)

// Severity represents the severity of a vulnerability, as defined by the Gitlab API.
type Severity string

const (
	SeverityUnknown  Severity = "unknown"
	SeverityInfo     Severity = "info"
	SeverityLow      Severity = "low"
	SeverityMedium   Severity = "medium"
	SeverityHigh     Severity = "high"
	SeverityCritical Severity = "critical"
)

// ToSeverity converts a string to a Severity, returning SeverityUnknown if the string is not recognized.
func ToSeverity(severity string) Severity {
	switch strings.ToLower(severity) {
	case "info":
		return SeverityInfo
	case "low":
		return SeverityLow
	case "medium":
		return SeverityMedium
	case "high":
		return SeverityHigh
	case "critical":
		return SeverityCritical
	}
	return SeverityUnknown
}

// ToSeverities converts a slice of strings to a slice of Severities.
func ToSeverities(severities []string) []Severity {
	result := make([]Severity, 0)
	for _, severity := range severities {
		result = append(result, ToSeverity(severity))
	}
	return result
}

// ContainsSeverity checks if a slice of Severities contains a specific Severity, returning true if it does.
func ContainsSeverity(severity Severity, severities []Severity) bool {
	for _, s := range severities {
		if s == severity {
			return true
		}
	}
	return false
}
